@use "sass:string";
@use "sass:map";
@use "sass:math";
@use "sass:list";

/*!
 * Industrial
 *
 * URL: https://git.z0m.bi/z0mbi/thelounge-theme-industrial
 * License: MIT
 */

$irc: ( 0: 'white', 1: 'black', 2: 'navy', 3: 'green', 4: 'red', 5: 'brown', 6: 'purple',
	7: 'orange', 8: 'yellow', 9: 'lime', 10: 'teal', 11: 'cyan', 12: 'blue', 13: 'fuchsia',
	14: 'gray', 15: 'lightgray'
);

$chars: (
	'a':'A','b':'B','c':'C','d':'D','e':'E','f':'F','g':'G','h':'H','i':'I','j':'J',
	'k':'K','l':'L','m':'M','n':'N','o':'O','p':'P','q':'Q','r':'R','s':'S','t':'T',
	'u':'U','v':'V','w':'W','x':'X','y':'Y','z':'Z'
);

$perceptual-hue-map: (
	0,    // Red
	15,   // Red-orange
	35,   // Orange  
	44,   // Yellow-orange
	60,   // Yellow
	75,   // Yellow-green
	120,  // Green
	180,  // Cyan
	206,  // Blue-cyan
	240,  // Blue
	270,  // Blue-violet
	300,  // Magenta
	320,  // Red-magenta
	360   // Red (full circle)
);

$base-hue-lightness: (
	0: 55%,   // Red
	15: 50%,  // Red-orange
	35: 50%,  // Orange  
	44: 50%,  // Yellow-orange
	60: 40%,  // Yellow
	75: 45%,  // Yellow-green
	120: 45%, // Green
	180: 45%, // Cyan
	206: 55%, // Blue-cyan
	240: 75%, // Blue
	270: 65%, // Blue-violet
	300: 50%, // Magenta
	320: 55%, // Red-magenta
	360: 55%  // Red (full circle)
);

$lighter: 15; //makes the darkest color lighter
$darker: 0; //makes the lightest color darker

// Function to interpolate between two values
// $start: starting value
// $end: ending value
// $factor: interpolation factor (0 to 1), greater number = closer to $end
@function lerp($start, $end, $factor) {
	@return $start + ($end - $start) * $factor;
}

// Function to sort a map by its values (ascending order)
// Returns a list of keys sorted by their corresponding values
// $map: the map to sort
@function sort-map-by-value($map) {
	$sorted-keys: ();
	$map-size: list.length(map.keys($map));

	// Selection sort: find minimum value in each pass
	@for $pass from 1 through $map-size {
		$min-value: 999999;
		$min-key: null;

		@each $key, $value in $map {
			// Skip keys already in sorted list
			$already-used: false;
			@each $used-key in $sorted-keys {
				@if $used-key == $key {
					$already-used: true;
				}
			}

			// Find the minimum value among remaining keys
			@if not $already-used and $value < $min-value {
				$min-value: $value;
				$min-key: $key;
			}
		}

		// Add the minimum key to sorted list
		@if $min-key != null {
			$sorted-keys: append($sorted-keys, $min-key);
		}
	}

	@return $sorted-keys;
}

// Fixed permutation map for shuffling (deterministic, not random)
// This creates a consistent shuffle that remains the same across renders
// Index 8 and 26 (letter Z) remain in place
$shuffle-map: (
	1: 17, 2: 5, 3: 23, 4: 11, 5: 29, 6: 3, 7: 19, 9: 31, 10: 14,
	11: 27, 12: 2, 13: 20, 14: 9, 15: 25, 16: 13, 17: 6, 18: 22, 19: 15, 20: 30,
	21: 21, 22: 10, 23: 18, 24: 28, 25: 1, 26: 4, 27: 16, 28: 7, 29: 24, 30: 12,
	31: 32, 32: 26,

	8: 8
);
$shuffle-letters: (
	'A': 'Q', 'B': 'W', 'C': 'T', 'D': 'R', 'F': 'Y', 'G': 'U', 'H': 'I',
	'I': 'O', 'J': 'P', 'K': 'M', 'L': 'S', 'M': 'K', 'N': 'F', 'O': 'G', 'P': 'H',
	'Q': 'J', 'R': 'D', 'S': 'L', 'T': 'A', 'U': 'X', 'V': 'C', 'W': 'V', 'X': 'B',
	'Y': 'N',

	'E': 'E', 'Z': 'Z', 
);

// Function to shuffle an index using the fixed permutation map
// $index: the original index (1-32)
// Returns: the shuffled index
@function shuffle-index($index) {
	//if there's no mapping, return the original index
	@if not map.has-key($shuffle-map, $index) {
		@return $index;
	}
	@return map.get($shuffle-map, $index);
}

// Function to get perceptually uniform hue
@function perceptual-hue($position) {
	// Clamp position between 0 and 1
	$pos: math.max(0, math.min(1, $position));

	// Calculate which segment we're in
	$map-length: list.length($perceptual-hue-map);
	$segment-size: math.div(1, ($map-length - 1));
	$segment-index: math.floor(math.div($pos, $segment-size));

	// Handle edge case for position = 1
	@if $segment-index >= $map-length - 1 {
		@return list.nth($perceptual-hue-map, $map-length);
	}

	// Get the two hues to interpolate between
	$lower-hue: list.nth($perceptual-hue-map, $segment-index + 1);
	$upper-hue: list.nth($perceptual-hue-map, $segment-index + 2);

	// Calculate interpolation factor within this segment
	$segment-start: $segment-index * $segment-size;
	$factor: math.div(($pos - $segment-start), $segment-size);

	// Interpolate between the two hues
	@return lerp($lower-hue, $upper-hue, $factor);
}

// Function to get base lightness for a given hue
@function get-hue-lightness($hue) {
  // Convert hue to 0-360 range
  $normalized-hue: $hue % 360;
  @if $normalized-hue < 0 {
    $normalized-hue: $normalized-hue + 360;
  }
  
  // Find the closest hue values in our lightness map
  $lower-hue: 0;
  $upper-hue: 360;
  $lower-lightness: map.get($base-hue-lightness, 0);
  $upper-lightness: map.get($base-hue-lightness, 360);
  
  // Find the surrounding hue values
  @each $hue-key, $lightness-value in $base-hue-lightness {
    @if $hue-key <= $normalized-hue {
      $lower-hue: $hue-key;
      $lower-lightness: $lightness-value;
    }
    @if $hue-key >= $normalized-hue and $upper-hue == 360 {
      $upper-hue: $hue-key;
      $upper-lightness: $lightness-value;
    }
  }
  
  // Handle edge case where we found exact match
  @if $lower-hue == $upper-hue {
    @return $lower-lightness;
  }
  
  // Interpolate between the lightness values
  $factor: math.div(($normalized-hue - $lower-hue), ($upper-hue - $lower-hue));
  $interpolated-lightness: lerp(math.div($lower-lightness, 1%), math.div($upper-lightness, 1%), $factor);
  
  @return $interpolated-lightness * 1%;
}

// Generates a color based on index, optional alpha, and fractional interpolation
// $num: current color index (0 to max)
// $max: total number of distinct colors (default is 31)
// $between: Number of fractional steps between adjacent colors (default is 0 - no interpolation)
// $between-max: Maximum number of fractional steps (default is 27 - for letters a-z)
// $a: alpha value (0-1) for transparency (default is 1 - fully opaque)
@function c($num: 0, $max-num: 31, $between: 0, $max-between: 27, $a: 1, $return-data:false) {
	
	$num: $num % ($max-num + 1);
	@if $num < 0 {
		$num: $num + ($max-num + 1);
	}
	$between: $between % ($max-between + 1);
	@if $between < 0 {
		$between: $between + ($max-between + 1);
	}

	// Divide by ($max-num + 1) to ensure position never reaches 1.0
	// This prevents wraparound where position 1.0 = position 0.0 (both red)
	$position: math.div($num, $max-num + 1);
	$h: perceptual-hue($position); // Perceptual hue based on position
	$s: 100; // Full saturation by default (unitless)
	$l: get-hue-lightness($h); // Get base lightness for this hue (unitless)

	@if $num % 2 != 0 {
		$l: $l + $lighter; // lighten odd numbers
	} @else {
		$l: $l - $darker; // darken even numbers
	}

	// If between interpolation is requested
	@if ($between > 0 and $max-between > 0) {
		// Convert between value to decimal (0-1 range)
		$dec: math.div($between, $max-between);

		// Calculate the next color's values
		$next-num: ($num + 1) % $max-num; // Wrap around if needed

		$next-color-data: c($num + 1, $max-num, 0, $max-between, $a, true);
		$next-num: map.get($next-color-data, 'num');
		$h-next: map.get($next-color-data, 'h');
		$l-next: map.get($next-color-data, 'l');

		// Apply the same odd/even lightness adjustment to the next color
		@if $next-num % 2 != 0 {
			$l-next: $l-next + $lighter;
		} @else {
			$l-next: $l-next - $darker;
		}

		// Calculate the distance between current and next color values
		// Handle hue wrapping (e.g., from 320 to 0)
		$h-dist: $h-next - $h;
		@if $h-dist > 180 {
			$h-dist: $h-dist - 360;
		} @else if $h-dist < -180 {
			$h-dist: $h-dist + 360;
		}

		$l-dist: $l-next - $l; // Lightness distance

		// Calculate how much to shift current values toward next color
		$h-frac: $h-dist * $dec; // Fractional hue shift
		$l-frac: $l-dist * $dec; // Fractional lightness shift

		// Adjust saturation based on letter position for even more color variety
		@if $between % 3 == 0 {
			$s: 70%; // Every 3rd letter: low saturation (more muted)
		} @else if $between % 2 == 0 {
			$s: 90%; // Every 2nd letter: medium saturation
		}
		// Otherwise keep 100% saturation (full vibrant color)

		// Apply the fractional interpolation to hue and lightness
		$h: $h + $h-frac;
		$l: $l + $l-frac;
	}

	// round to 2 decimal places to avoid precision issues
	$h: math.div(math.round($h * 100), 100);
	$l: math.div(math.round($l * 100), 100);
	$s: math.div(math.round($s * 100), 100);
	$a: math.div(math.round($a * 100), 100);

	@if $return-data {
		@return (
			'num': $num,
			'h': $h,
			's': $s,
			'l': $l,
			'a': $a,
			'hsla': hsla($h, $s * 1%, $l, $a)
		);
	}

	@return hsla($h, $s * 1%, $l, $a);
}

// Applies consistent text styling for the theme's distinctive typography
// Converts text to lowercase, applies 'Major Mono Display' monospace font, and makes it bold
// Used primarily for headings and network/lobby names to maintain theme aesthetic
@mixin lower_mono()
{
	text-transform: lowercase;
	font-family: 'Major Mono Display', monospace !important;
	font-weight: bold;
}

@import url('https://fonts.googleapis.com/css?family=Major+Mono+Display&display=swap');

$letter-colors: ();
$color-colors: ();

:root {
	$letter: 0;
	@each $lower, $upper in $chars {
		$shuffled-upper: map.get($shuffle-letters, $upper);
		$letter-color: c($letter + 14, list.length($chars) - 1, 0, 0, 1, true);
		$letter-colors: map.merge($letter-colors, ($shuffled-upper: $letter-color)) !global;
		--color-#{$upper}: #{map.get($letter-color, 'hsla')};
		$letter: $letter + 1;
	}

	@for $i from 1 through 32 {
		$shuffled-i: shuffle-index($i);
		$color-color: c($i + 6, 31, 0, 0, 1, true);
		$color-colors: map.merge($color-colors, ($shuffled-i: $color-color)) !global;
		--color-#{$i}: #{map.get($color-color, 'hsla')};
	}

	$letter: 0;
	@each $lower, $upper in $chars {
		$letter-color: map.get($letter-colors, $upper);
		$h-letter: map.get($letter-color, 'h');
		@for $i from 1 through 32 {
			$color-color: map.get($color-colors, $i);
			$h-color: map.get($color-color, 'h');

			$h: lerp($h-letter, $h-color, 0.2);
			$s: map.get($letter-color, 's');
			$l: map.get($letter-color, 'l');
			$a: map.get($letter-color, 'a');

			--color-#{$i}#{$upper}: #{hsla($h, $s * 1%, $l, $a)};
		}
		$letter: $letter + 1;
	}

	--color-white: white;
	--color-black: black;
	--color-navy: navy;
	--color-green: #009a00;
	--color-red: red;
	--color-brown: brown;
	--color-purple: #cc00ff;
	--color-orange: #FF9E17;
	--color-yellow: yellow;
	--color-lime: #29ff29;
	--color-teal: #00a0a0;
	--color-cyan: cyan;
	--color-blue: #2453ff;
	--color-fuchsia: fuchsia;
	--color-gray: gray;
	--color-lightgray: lightgray;

	--body-bg-color: var(--color-black);
	--window-bg-color: var(--color-black);
	--body-color: var(--color-white);
	--body-color-muted: var(--color-gray);
	--link-color: var(--color-lime);
	--unread-marker-color: var(--color-fuchsia);
	--date-marker-color: var(--color-orange);
	--highlight-bg-color: var(--color-brown);
	--highlight-border-color: var(--color-orange);
	--background-light-color: var(--color-black);
	--button-color: var(--color-lime);
	--button-text-color-hover: var(--color-black);
	--overlay-bg-color: var(--color-black);
	--window-heading-color: var(--color-gray);
	--upload-progressbar-color: var(--button-color);
}

::-webkit-scrollbar {
	display: none;
}

/* Samsung Internet and Microsoft Edge (yes, both of them use -webkit- prefix) */
::-webkit-input-placeholder {
	color: rgba(128, 128, 128, 1);
}

::placeholder {
	color: rgba(131, 148, 150, 0.9);
	opacity: 1; /* fix opacity in Firefox */
}

::-webkit-scrollbar-thumb
{
	&:vertical {
		background: h(192, 100%, 25%);

		&:hover {
			background: h(192, 100%, 30%);
		}

		&:active {
			background: h(192, 100%, 40%);
		}
	}
}

html {
	scrollbar-color: h(192, 100%, 25%) h(192, 100%, 25%, 10%);
	scrollbar-width: thin;
}

* {
	font-family: monospace, monospace !important;
	font-size: 13px;
}

#viewport .lt::before,
#viewport .rt::before,
#chat button.mentions::before,
#chat button.close::before,
#chat button.menu::before,
#chat button.search::before,
.channel-list-item::before,
#footer .icon,
#chat .count::before,
#connect .extra-help,
#settings .extra-help,
#settings #play::before,
#settings .settings-menu .icon::before,
#form #upload::before,
#form #submit::before,
#chat .msg[data-type="away"] .from::before,
#chat .msg[data-type="back"] .from::before,
#chat .msg[data-type="invite"] .from::before,
#chat .msg[data-type="join"] .from::before,
#chat .msg[data-type="kick"] .from::before,
#chat .msg[data-type="login"] .from::before,
#chat .msg[data-type="logout"] .from::before,
#chat .msg[data-type="part"] .from::before,
#chat .msg[data-type="quit"] .from::before,
#chat .msg[data-type="topic"] .from::before,
#chat .msg[data-type="mode_channel"] .from::before,
#chat .msg[data-type="mode_user"] .from::before,
#chat .msg[data-type="mode"] .from::before,
#chat .msg[data-command="motd"] .from::before,
#chat .msg[data-command="help"] .from::before,
#chat .msg[data-command="info"] .from::before,
#chat .msg[data-type="ctcp"] .from::before,
#chat .msg[data-type="ctcp_request"] .from::before,
#chat .msg[data-type="whois"] .from::before,
#chat .msg[data-type="nick"] .from::before,
#chat .msg[data-type="action"] .from::before,
#chat .msg[data-type="plugin"] .from::before,
#chat .msg[data-type="raw"] .from::before,
#chat .msg-statusmsg span::before,
#chat .msg-shown-in-active span::before,
#chat .toggle-button::after,
#chat .toggle-content .more-caret::before,
#chat .scroll-down-arrow::after,
#chat .topic-container .save-topic span::before,
#version-checker::before,
.context-menu-item::before,
#help .website-link::before,
#help .documentation-link::before,
#help .report-issue-link::before,
#image-viewer .previous-image-btn::before,
#image-viewer .next-image-btn::before,
#image-viewer .open-btn::before,
.channel-list-item .not-secure-icon::before,
.channel-list-item .not-connected-icon::before,
.channel-list-item .parted-channel-icon::before,
.jump-to-input::before,
.password-container .reveal-password span,
#sidebar .collapse-network-icon::before {
	//font: normal normal normal 13px/1 FontAwesome !important;
	font-family: FontAwesome !important;
	font-size: inherit; /* Can't have font-size inherit on line above, so need to override */
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

h1, h2, h3, h4
{
	@include lower_mono();
}

#context-menu,
.textcomplete-menu
{
	background-color: var(--background-light-color);
	border: 1px solid var(--color-purple);

	.textcomplete-item,
	.context-menu-item {
		color: var(--color-white);

		a {
			color: var(--color-white);
		}

		&:hover,
		&:focus,
		.active {
			background-color: var(--color-navy);
		}
	}
}

button.btn,
input.input,
select.input
{
	border: 2px solid var(--button-color);
	color: var(--button-color);
	background-color: transparent;
}

select.input option {
	background-color: var(--button-color);
	color: var(--color-black);
	font-weight: bold;
}

#input
{
	background-color: inherit;
}

#settings
{
	.error {
		color: var(--color-red);
	}

	#play,
	.extra-help {
		color: var(--color-gray);
	}
}

#viewport
{
	.lt,
	.rt {
	 color: var(--body-color-muted);
	}
}

.window
{
	h1 { color: var(--color-yellow) }

	h2 {
		color: var(--color-orange);
		border-bottom: 1px solid var(--color-orange);
	}

	h3 { color: var(--color-fuchsia) }
}

#version-checker
{
	&.new-packages,
	&.new-version {
		color: var(--color-black);
		background-color: var(--color-yellow);
	}
}

.irc-monospace,
code
{
	background-color: transparent;
	color: var(--color-red);
	font-weight: bold;
}

#user-specified-css-input {
	height: 500px;
}

.scroll-down:hover .scroll-down-arrow {
	background-color: var(--color-lime);
}

#sidebar
{
	border-right: 1px solid var(--color-purple);

	.networks {
		padding: 5px 0;

		.network {
			margin-bottom: 10px;

			.collapse-network-icon {
				line-height: 24px;
			}
		}
	}

	.jump-to-results .channel-list-item,
	.channel-list-item {
		padding: 1px 10px;
		color: var(--color-white);

		&:hover {
			background-color: transparent;
			color: var(--color-lime);
		}

		.not-connected-tooltip,
		.not-secure-tooltip,
		.parted-channel-tooltip {
			display: inline-block;
			margin-top: 3px;
		}

		.name {
			line-height: 18px;
			margin-top: 2px;
		}

		.lobby-wrap .name {
			@include lower_mono();
		}

		.badge {
			background-color: var(--color-navy);
			color: var(--color-yellow);
			font-weight: bold;
			padding-top: 6px;

			&.highlight {
				border: 1px solid var(--color-yellow);
				padding: 5px 5px 3px;
			}
		}

		&.active,
		&.active:hover {
			background-color: var(--color-navy);
		}

		&.not-connected,
		&.parted-channel {
			color: var(--color-red)
		}

		&[data-type=lobby] {
			padding: 1px 10px;
			color: var(--color-lime);
			line-height: 20px;

			.add-channel {
				line-height: 26px;
			}

			&.not-secure,
			&.not-secure.active,
			&.not-secure .lobby-wrap:hover {
				color: var(--color-orange)
			}

			&.not-connected,
			&.not-connected.active,
			&.not-connected .lobby-wrap:hover, {
				color: var(--color-red)
			}
		}
	}
}

#form
{
	border: none;
	border-top: 1px solid var(--color-purple);
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	align-items: start;
	background-color: inherit;

	#nick {
		display: block;
		color: var(--color-lime);
		font-weight: bold;
		flex: 0 0 auto;
		background-color: inherit;
		@include lower_mono();

		&:after { content: ']'; }
		&:before { content: '['; }
	}

	#input {
		border: 0;
		color: var(--body-color);
		flex: 1 1 auto;
	}

	.input {
		background-color: inherit;
	}

	#upload-tooltop,
	#submit-tooltop {
		flex: 0 0 auto;
	}

	#submit,
	#upload {
		color: var(--body-color-muted);
	}
}

#chat {
	.chat {
		border-right: 1px solid var(--color-purple);
	}

	.count::before,
	button.menu {
		color: var(--body-color-muted);
	}

	.self .content {
		color: var(--color-lightgray);
	}

	.header {
		background-color: var(--color-navy);
		border: none;

		.topic {
			color: var(--color-white);
			font-weight: bold;
		}
	}

	.toggle-content {
		background-color: var(--background-light-color);
	}

	.msg[data-command=motd],
	.msg[data-type=motd] {
		.text {
			background-color: var(--background-light-color);
			line-height: 1rem;

			> span {
				font-size: 1rem;
				display: inline-block;
			}
		}
	}

	table.channel-list,
	table.ban-list {
		th,
		td {
			border-bottom-color: transparent;
		}
	}

	table.ban-list td {
		color: var(--color-red);
	}

	.notice {
		.content, .time {
			color: var(--color-teal) !important;
		}
	}

	.action {
		.content, .from, .user {
			color: var(--color-orange);
			font-style: italic;
		}
	}

	.chat-view[data-type=channel] {
		.msg.highlight {
			background-color: transparent;
			border-left: 5px solid transparent;

			.from .user {
				background-color: var(--color-purple);
				color: var(--color-yellow) !important;
				font-weight: bold;
			}

			.content {
				border-left: 1px solid var(--color-yellow);
			}
		}

		.notice .user {
			color: var(--color-teal) !important;
		}
	}

	.content {
		border-left: 1px solid var(--color-lime);
	}

	.content, .from, .time {
		padding-top: 0;
		padding-bottom: 0;
	}

	.unread-marker:before {
		border: 1px dashed var(--unread-marker-color)
	}

	.userlist {
		border: none;

		.user.active {
			background-color: var(--color-navy);
		}

		.search {
			border: 0;
			color: var(--body-color);
		}

		.count {
			background-color: inherit;
		}
	}

	.user-mode {
   		margin-bottom: 0px;
		padding-bottom: 3px;
		background-color: rgba(255,255,255,.07);
		border: 1px solid rgba(255,255,255,.35);

		&:before {
			color: rgba(255,255,255,.7);
			background-color: transparent;
			padding-bottom: 0;
			@include lower_mono();
		}

		.user {
			//color: var(--color-white) !important;

			&:after {
				padding: 0 16px 0 24px;
			}

			&.active {
				background-color: transparent;
				color: var(--color-lime) !important;
			}
		}

		&.owner {
			background-color: rgba(0,220,255,.1);
			border: 1px solid rgba(0,220,255,.35);

			&:before {
				color: rgba(0,220,255,1)
			}
		}

		&.admin {
			background-color: rgba(0,255,0,.1);
			border: 1px solid rgba(0,255,0,.35);

			&:before {
				color: rgba(0,255,0,1)
			}
		}

		&.op {
			background-color: rgba(253,187,0,.1);
			border: 1px solid rgba(253,187,0,.35);

			&:before {
				color: rgba(253,187,0,1)
			}
		}

		&.half-op {
			background-color: rgba(253,70,0,.1);
			border: 1px solid rgba(253,70,0,.35);

			&:before {
				color: rgba(253,70,0,1)
			}
		}

		&.voice {
			background-color: rgba(195,0,253,.1);
			border: 1px solid rgba(195,0,253,.35);

			&:before {
				color: rgba(195,0,253,1)
			}
		}
	}
}

#footer
{
	button
	{
		&:hover {
			background-color: transparent;
			color: var(--color-lime);
		}

		&.active {
			background-color: var(--color-navy);
		}
	}
}

@each $i, $color in $irc {
	.irc-bg#{$i} { background: var(--color-#{$color}); }
	.irc-fg#{$i} { color: var(--color-#{$color}); }
}

// Controls nickname styling based on brightness/darkness of assigned color
// Parameters:
//   $dark: Whether to use bold font weight (for darker colors) or normal (for lighter colors)
//   $color: Color index (not currently used in implementation)
//   $upper: Whether the nickname starts with uppercase (not currently used in implementation)
// Applies bold styling for dark colors to improve readability, hides :after pseudo-element for light colors
@mixin dark_nick($dark:true, $color:1, $upper:false) {
	@if $dark {
		// For darker colors: use bold text to make it stand out and improve readability
		font-weight: bold;
	} @else {
		// For lighter/brighter colors: use normal weight
		font-weight: normal;
		// Hide the :after pseudo-element for lighter colors (no visual indicator needed)
		&:after {
			display: none;
		}
	}
}

// Determines nickname text styling based on color index and first letter position
// Parameters:
//   $color: Color index (1-32) determining the base nickname color
//   $letter: Alphabetical position (0-25) of nickname's first letter
//   $upper: Whether the first letter is uppercase
// Logic: For even-indexed colors, first 6 letters (a-f) are bold; for odd-indexed colors, last 6 letters (u-z) are bold
// This creates visual variety in nickname styling based on their assigned color and first character
@mixin extra_color($color:1, $letter:0, $upper:false)
{
	// Check if color index is even
	@if $color % 2 == 0 {
		// For even colors: make letters a-f (positions 0-5) bold
		@if($letter < 6) {
			@include dark_nick(true, $color, $upper); // Bold styling
		} @else {
			@include dark_nick(false); // Normal weight for g-z
		}
	} @else {
		// For odd colors: make letters u-z (positions 21-25) bold
		@if ($letter > 20) {
			@include dark_nick(true, $color, $upper); // Bold styling
		} @else {
			@include dark_nick(false); // Normal weight for a-t
		}
	}
}

#chat.colored-nicks
{
	.from .user {
		display: inline-block;
		width: 100%;

		&:after {
			padding-left: 8px;
		}
	}

	@for $i from 1 through 32 {
		$letter: 0;

		.user.color-#{$i} {
			color: var(--color-#{$i});
			position: relative;
			@include extra_color($i, $letter);

			@each $lower, $upper in $chars {
				&[data-name^='#{$lower}'], &[data-name^='#{$upper}'] {
					color: var(--color-#{$i}#{$upper});
					@include extra_color($i, $letter, $upper);
				}
				$letter: $letter + 1;
			}
		}
	}

	.userlist 
	{
		@for $i from 1 through 32 {
			$letter: 0;

			.user.color-#{$i} {
				//color: var(--color-white);
				//font-weight: normal;

				@each $lower, $upper in $chars {
					&[data-name^='#{$lower}'], &[data-name^='#{$upper}']
					{
						//color: var(--color-white);
						//font-weight: normal;
						&::first-letter {
							color: var(--color-#{$i}#{$upper});
							@include extra_color($i, $letter, $upper);
						}
					}
					$letter: $letter + 1;
				}
			}
		}
	}
}
